#### Установка Samba
```bash
$ sudo apt install samba
```
###### Разные дистрибутивы по‑разному именуют юнит systemd для Samba:

**Debian, Ubuntu (до Debian 11):** используют имя smbd.service (и nmbd.service для NetBIOS).

**RHEL, CentOS, Fedora, AlmaLinux, Rocky Linux:** используют имя smb.service (и nmb.service).

**Debian 12 и новее:** поддерживают оба варианта (smb.service и smbd.service) для совместимости.

###### Что внутри

**smbd (демоном Samba)** — это реальный исполняемый процесс, который всегда называется smbd (независимо от имени юнита systemd).

**smb.service / smbd.service** — это конфигурационный файл systemd (юнит), указывающий, как запускать и контролировать процесс smbd.

###### Посмотрите список установленных юнитов
```bash
$ sudo systemctl list-unit-files | grep -E 'smb\.service|smbd\.service'
```
#### После установки добавим службу в автозагрузку
```bash
$ sudo systemctl enable smbd
```
#### После чего запустите службу smbd:
```bash
$ sudo systemctl start smbd
```
#### Соответственно для просмотра текущего состояния демона используйте команду:
```bash
$ sudo systemctl status smbd
```
> P.s. Если на виртуальном сервере во время предварительной настройки включен брандмауэр, то надо добавить разрешающее правило для установленной утилиты:
```bash
$ sudo ufw allow Samba
```
#### Редактируем конфигурационный файл samba. Переходим в каталог /etc/samba/ и сохраните файл smb.conf в качестве резервной копии под именем, например, smb_bak.conf.
```bash
$ cd /etc/samba
$ sudo cp smb.conf smb_bak.conf
```
> Теперь, когда есть резервная копия конфигурационного файла, вы можете корректировать его, имея возможность в любой момент отменить все внесённые изменения.

### Настройка каталога для анонимного доступа
Cоздадим директорию и откроем доступ к ней таким образом, чтобы клиент мог иметь возможность подключиться к ней без авторизации на сервере. 

Анонимный пользователь не сможет редактировать или удалять файлы и каталоги, находящиеся в общей директории, а также у него не будет возможности создавать в ней свои директории или файлы.

Сначала создайте директорию, которую будете использовать для общего доступа. Например:
```bash
$ sudo mkdir /var/share_anon
```
Теперь перейдите в каталог /etc/samba/ и откройте для редактирования конфигурационный файл:
```bash
$ cd /etc/samba
$ sudo nano smb.conf
```
В конец файла smb.conf добавьте следующий раздел:
```bash
[public_anon]
    comment = Directory For Anonymous Users
    path = /var/public_anon
    public = yes
    writable = no
    read only = yes
    guest ok = yes
```
Здесь:

**[public_anon]** – имя ресурса, которое будет видеть клиент;<br>
**comment** – комментарий к данному разделу конфигурационного файла (в нашем случае – Directory For Anonymous Users);<br>
**path** – каталог, к которому предоставлен общий доступ (в нашем примере – /var/share_anon);<br>
**public** – признак возможности доступа гостевым пользователям и пользователям, прошедшим авторизацию (значение yes подразумевает предоставление доступа на чтение для данных пользователей);<br>
**writable** – возможность внесения изменений в содержимое общего каталога;<br>
**read only** – право только на чтение (в нашем примере значение yes говорит о том, что все пользователи имеют право исключительно на чтение содержимого директории);<br>
**guest ok** – признак возможности доступа гостевой учётной записи.<br>

После окончания редактирования закройте файл с сохранением изменений. Для этого нажмите Ctrl x, затем y и Enter. Для того, чтобы внесённые в конфигурацию изменения применились, перезапустите службу smbd:
```bash
$ sudo systemctl restart smbd
```
При помощи команды testparm проверьте, что внесённые изменения стали частью конфигурации Samba.
```bash
$ sudo testparm
```
Теперь можно проверить доступ по IP, например \\ваш IP\

### Настройка каталога для доступа авторизованного пользователя
Настроим каталог, к которому авторизованные учётные записи будут иметь полный доступ. То есть, пользователи, прошедшие авторизацию на сервере смогут редактировать, создавать и удалять файлы и директории в данном каталоге.






